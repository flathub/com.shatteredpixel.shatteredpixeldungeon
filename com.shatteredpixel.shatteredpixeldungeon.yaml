app-id: com.shatteredpixel.shatteredpixeldungeon
runtime: org.freedesktop.Platform
runtime-version: '19.08'
sdk: org.freedesktop.Sdk
command: com.shatteredpixel.shatteredpixeldungeon.sh
sdk-extensions:
- org.freedesktop.Sdk.Extension.openjdk11
finish-args:
- --socket=wayland
- --socket=x11
- --share=ipc
- --device=dri
- --env=PATH=/usr/bin:/app/bin:/app/jre/bin
- --socket=pulseaudio
- --persist=.shatteredpixel
modules:
- name: openjdk
  buildsystem: simple
  build-commands:
    - /usr/lib/sdk/openjdk11/install.sh

- name: xrandr
  sources:
  - type: archive
    url: https://xorg.freedesktop.org/archive/individual/app/xrandr-1.5.0.tar.gz
    sha256: ddfe8e7866149c24ccce8e6aaa0623218ae19130c2859cadcaa4228d8bb4a46d

- name: shatteredpixeldungeon
  buildsystem: simple
  build-commands:
  - echo "java -jar /app/share/com.shatteredpixel.shatteredpixeldungeon/com.shatteredpixel.shatteredpixeldungeon.jar" > com.shatteredpixel.shatteredpixeldungeon.sh
  - install -Dm755 com.shatteredpixel.shatteredpixeldungeon.sh /app/bin/com.shatteredpixel.shatteredpixeldungeon.sh
  - install -Dm644 com.shatteredpixel.shatteredpixeldungeon.desktop /app/share/applications/com.shatteredpixel.shatteredpixeldungeon.desktop
  - install -Dm644 com.shatteredpixel.shatteredpixeldungeon.appdata.xml /app/share/metainfo/com.shatteredpixel.shatteredpixeldungeon.appdata.xml
  - install -Dm644 com.shatteredpixel.shatteredpixeldungeon.png /app/share/icons/hicolor/48x48/apps/com.shatteredpixel.shatteredpixeldungeon.png
  - install -Dm644 com.shatteredpixel.shatteredpixeldungeon.jar /app/share/com.shatteredpixel.shatteredpixeldungeon/com.shatteredpixel.shatteredpixeldungeon.jar
  sources:
  - type: file
    url: https://github.com/00-Evan/shattered-pixel-dungeon/releases/download/v0.8.0b/ShatteredPD-v0.8.0b-Desktop.jar
    sha256: 5a662a4ca33e2f2c42ea1841edae4efe7a6f264af45383bee9ebd2b5c140bed4
    dest-filename: com.shatteredpixel.shatteredpixeldungeon.jar
  - type: file
    path: com.shatteredpixel.shatteredpixeldungeon.desktop
  - type: file
    path: com.shatteredpixel.shatteredpixeldungeon.appdata.xml
  - type: file
    url: https://raw.githubusercontent.com/00-Evan/shattered-pixel-dungeon/master/desktop/src/main/assets/icon_128.png
    sha256: 7d6f39c72d6a46f14ea751b364f8393b152d569853e8231a52346046b8421240
    dest-filename: com.shatteredpixel.shatteredpixeldungeon.png
